# -*- coding: utf-8 -*-
"""
Created on Thu Jan 11 15:33:36 2024

@author: brittsc

The vertical levels that soil temperature is given/required on is
different for NorESM2 and the WRF met_em file. This code is for
interpolating in between the two grids (from NorESM to WRF).
Results are printed and copied into the script modify_met_em_files.py.
"""

import numpy as np
from scipy.interpolate import CubicSpline

soil_levels_NorESM = np.array([1.00000000e-02, 4.00000000e-02, 
       9.00000000e-02, 1.60000000e-01, 2.60000000e-01, 4.00000000e-01, 
       5.80000000e-01, 8.00000000e-01, 1.06000000e+00, 1.36000000e+00, 
       1.70000000e+00, 2.08000000e+00, 2.50000000e+00, 2.99000000e+00, 
       3.58000000e+00, 4.27000000e+00, 5.06000000e+00, 5.95000000e+00, 
       6.94000000e+00, 8.03000000e+00, 9.79500000e+00, 1.33277670e+01, 
       1.94831292e+01, 2.88707244e+01, 4.19984369e+01])

soil_warming_NorESM_1955 = np.array([0.89760494, 0.86802077, 0.81866848, 
                                     0.74900681, 0.64731151, 0.50364423, 
                                     0.3248421 , 0.11470871, -0.08919687,
                                     -0.24415709, -0.39561847, -0.53612775,
                                     -0.64911562, -0.73168349, -0.76403344,
                                     -0.73925912, -0.65846753, -0.5420109 ,
                                     -0.4261184 , -0.33401388, -0.27912205,
                                     -0.26718757, -0.3334755 , -0.48141813, 
                                     -0.64347595])

soil_warming_NorESM_1963 = np.array([1.09825778,  1.06894279,  1.01946771,
                                     0.9500789 ,  0.84723377,  0.70078158, 
                                     0.51659536,  0.30001667,  0.09129538, 
                                     -0.07433759, -0.2456256 , -0.4132489,
                                     -0.56298727, -0.69754702, -0.8024947,
                                     -0.87502021, -0.90510207, -0.8936646,
                                     -0.86308551, -0.83163691, -0.81033218,
                                     -0.80013031, -0.79825604, -0.76998556,
                                     -0.74773943])

soil_warming_NorESM_2040 = np.array([1.41972852, 1.41493893, 1.40658009, 
                                     1.39479148, 1.37481165, 1.34448862,
                                     1.31395292, 1.25610018, 1.16062212,
                                     1.08069122, 1.0063349,	 0.9174695,
                                     0.81942296, 0.71025079, 0.58930075,
                                     0.46072346, 0.33768979, 0.2353605 ,
                                     0.15647554, 0.09458977, 0.04603612, 
                                     -0.01773707, -0.14742029, -0.30652183,
                                     -0.42105854])

soil_warming_NorESM_2047 = np.array([3.55771017,  3.55614233,  3.55309463,
                                     3.54761195,  3.53963423,  3.52927876, 
                                     3.51856732,  3.4538672 ,  3.2895112 , 
                                     3.0857327 ,  2.84384513,  2.55847025, 
                                     2.2555325 ,  1.93696284,  1.61163819,
                                     1.2995882 ,  1.03705156,  0.8504011 , 
                                     0.72773939,  0.63721675,  0.55708688, 
                                     0.41739458,  0.13137178, -0.17188281, 
                                     -0.37182775])

soil_warming_NorESM_2058 = np.array([5.33841467, 5.35509968, 5.37870836, 
                                     5.40599775, 5.43565273, 5.47242403, 
                                     5.50323534, 5.45810747, 5.24837971, 
                                     4.92818451, 4.53926039, 4.09549713, 
                                     3.64040971, 3.17833543, 2.73198533,
                                     2.33650064, 2.04518366, 1.88797796, 
                                     1.8329438 , 1.821473  , 1.79759777, 
                                     1.65394485, 1.22610319, 0.67874193, 
                                     0.23569705])

soil_warming_NorESM_2074 = np.array([5.55616856, 5.57749796, 5.60893679,
                                     5.6496191 , 5.69468117, 5.75605869,
                                     5.85524416, 5.92054701, 5.7322402 ,
                                     5.39058828, 4.97257948, 4.4993906 , 
                                     4.01622152, 3.52800846, 3.06283331,
                                     2.66104674, 2.38435078, 2.26650071, 
                                     2.26936674, 2.32976961, 2.37533927,
                                     2.31604004, 2.01449275, 1.6133914 ,
                                     1.27391672])

soil_levels_met_em = np.array([0.035, 0.175, 0.64, 1.945, 5.0])

warming_signal = CubicSpline(soil_levels_NorESM,soil_warming_NorESM_2074)
delta_T_WRF = warming_signal(soil_levels_met_em)

print(delta_T_WRF)
